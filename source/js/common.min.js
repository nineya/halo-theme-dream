(()=>{window.encrypt=e=>window.btoa(unescape(encodeURIComponent(e))),window.decrypt=e=>decodeURIComponent(escape(window.atob(e)));const t={initWidget(){const e=$(".columns .column-right"),t=$(".columns .column-right-shadow");if(e.length&&t.length&&!t[0].children.length)for(const o of e[0].children)t[0].append(o.cloneNode(!0))},initActions(){const o=$(".actions>.bullet-screen");if(0===$("halo-comment[bullet-screen]").length)o.addClass("is-hidden-all");else if("true"===localStorage.getItem("stop-bullet-screen")&&o.addClass("stop-bullet-screen"),o.removeClass("is-hidden-all"),!window.initActionsComplete)o.on("click",()=>{let e=localStorage.getItem("stop-bullet-screen")||!1;var t;t="true"!==e.toString(),$("halo-comment[bullet-screen]").each(function(){var e=this.shadowRoot.getElementById("halo-comment");t?$(e).attr("stop-bullet-screen","true"):$(e).removeAttr("stop-bullet-screen")}),t?o.addClass("stop-bullet-screen"):o.removeClass("stop-bullet-screen"),localStorage.setItem("stop-bullet-screen",t)}),window.initActionsComplete=!0},initTocAndNotice(){var e=location["pathname"],t=(window.tocPjax&&window.tocPjax(),0===$(".widget.toc .card-content ul").length),e="toc"===DreamConfig.notice_show_mode&&!t||"index"===DreamConfig.notice_show_mode&&"/"!==e;t?$(".widget.toc,.action-toc").addClass("is-hidden-all"):$(".widget.toc,.action-toc").removeClass("is-hidden-all"),e?$(".widget.notice").addClass("is-hidden-all"):$(".widget.notice").removeClass("is-hidden-all")},initBanner(){const n=$(".banner-info-desc");if(0!==n.length){const s=n.text();n.text("");let t,o="",a=!0;const i=function(){var e=o.length;a&&e<s.length?(o+=s.charAt(e),n.text(o)):!a&&0<e?(o=o.slice(0,e-1),n.text(o)):(clearInterval(t),a=!a,t=setInterval(i,a?500:80))};t=setInterval(i,a?500:80)}},widgetFixedBottom(){const e=$(".left-bottom")[0],t=$(".right-bottom")[0];function o(){window.innerWidth<769?e.style.top=null:e.style.top=window.innerHeight-e.scrollHeight-10+"px"}function a(){1216<=window.innerWidth&&(t.style.top=window.innerHeight-t.scrollHeight-10+"px")}e&&(o(),$(window).resize(o),document.addEventListener("scroll",o)),t&&(a(),$(window).resize(a),document.addEventListener("scroll",a))},initGallery(){$(".main-content img:not(.not-gallery)").each(function(){0===$(this).parents("[data-fancybox],mew-photos").length&&$(this).wrap(`<div class="gallery-item"><div data-fancybox="gallery" ${this.alt?`data-caption="${this.alt}"`:""} href="${$(this).attr("src")}"></div>${this.alt?`<p>${this.alt}</p>`:""}</div>`)})},initMode(){let e=localStorage.getItem("night")||!1;const t=t=>{t?document.documentElement.classList.add("night"):document.documentElement.classList.remove("night"),$("halo-comment").each(function(){var e=this.shadowRoot.getElementById("halo-comment");$(e)[(t?"add":"remove")+"Class"]("night")}),localStorage.setItem("night",t),e=t};$("#toggle-mode").on("click",()=>t("true"!==e.toString())),"system"===DreamConfig.default_theme&&window.matchMedia("(prefers-color-scheme: dark)").addListener(e=>t(e.matches))},initNavbar(){const t=$(".navbar-nav a"),e=$(".panel-side-menu .link");let o=0;const{href:a,pathname:n}=location;if(n&&"/"!==n)for(let e=0;e<t.length;e++){const s=t[e].getAttribute("href");if((n.includes(s)||a.includes(s))&&(o=e,n===s||a===s))break}const s=t.eq(o);s.addClass("current"),s.parents(".item-dropdown").length&&s.parents(".item-dropdown").find(".item-dropdown-link a").addClass("current"),e.eq(o).addClass("current")},initDropMenu(){$(".item-dropdown").each(function(e,t){const o=$(this).find(".item-dropdown-menu"),a=$(t).attr("trigger")||"click",n=$(t).attr("placement")||$(this).height()||0;o.css("top",n),"hover"===a?$(this).hover(()=>$(this).addClass("active"),()=>$(this).removeClass("active")):($(this).on("click",function(e){e.stopPropagation(),$(this).toggleClass("active"),$(document).one("click",()=>$(this).removeClass("active")),e.stopPropagation()}),o.on("click",e=>e.stopPropagation()))})},initScroll(){let i=0;document.addEventListener("scroll",()=>{const e=$(document).scrollTop(),t=(s=(n=e)>i,i=n,s),o=$("body"),a=$(".actions");var n,s;50<e&&t?o.addClass("move-up"):o.removeClass("move-up"),100<e?a.addClass("show"):a.removeClass("show")})},searchDialog(){const t=$(".navbar-search .result");$(".navbar-search .input").on("click",function(e){e.stopPropagation(),t.addClass("active")}),$(document).on("click",function(){t.removeClass("active")})},drawerMobile(){$(".navbar-slideicon").on("click",function(e){e.stopPropagation(),$(".navbar-searchout").removeClass("active");const t=$("html"),o=$(".navbar-mask"),a=$(".navbar-slideout");a.hasClass("active")?(t.removeClass("disable-scroll"),o.removeClass("active slideout"),a.removeClass("active")):(t.addClass("disable-scroll"),o.addClass("active slideout"),a.addClass("active"))}),$(".action-toc").on("click",function(e){e.stopPropagation(),$(".navbar-searchout").removeClass("active");const t=$("html"),o=$(".navbar-mask"),a=$(".navbar-slideout");a.hasClass("active")?(t.removeClass("disable-scroll"),o.removeClass("active slideout"),a.removeClass("active slideout-toc")):(t.addClass("disable-scroll"),o.addClass("active slideout"),a.addClass("active slideout-toc"))})},back2Top(){$("#back-to-top").on("click",function(){$("body, html").animate({scrollTop:0},400)})},searchMobile(){$(".navbar-searchicon").on("click",function(e){e.stopPropagation(),$(".navbar-slideout").removeClass("active");const t=$("html"),o=$(".navbar-mask"),a=$(".navbar-above"),n=$(".navbar-searchout");n.hasClass("active")?(t.removeClass("disable-scroll"),o.removeClass("active slideout"),n.removeClass("active"),a.removeClass("solid")):(t.addClass("disable-scroll"),o.addClass("active"),a.addClass("solid"),n.addClass("active"))})},maskClose(){$(".navbar-mask").on("click",function(e){e.stopPropagation(),$("html").removeClass("disable-scroll"),$(".navbar-mask").removeClass("active slideout"),$(".navbar-searchout").removeClass("active"),$(".navbar-slideout").removeClass("active slideout-toc"),$(".navbar-above").removeClass("solid")}).on("touchmove",e=>e.preventDefault),$(".navbar .toc-content").on("click",function(e){e.stopPropagation(),$("html").removeClass("disable-scroll"),$(".navbar-mask").removeClass("active slideout"),$(".navbar-slideout").removeClass("active slideout-toc")})},sideMenuMobile(){$(".navbar-slideout-menu .current").parents(".panel-body").show().siblings(".panel").addClass("in"),$(".navbar-slideout-menu .panel").on("click",function(e){e.stopPropagation();const t=$(this),o=t.parent().parent();o.find(".panel").not(t).removeClass("in"),o.find(".panel-body").not(t.siblings(".panel-body")).stop().hide("fast"),t.toggleClass("in").siblings(".panel-body").stop().toggle("fast")})},initEvent(){let e=$("body");function o(e){let t=$(e);const o=t.attr("data-close");return o&&""!==o.trim()?t.closest(o.trim()):t}e.on("click",".click-close",function(e){e.stopPropagation(),o(this).remove()}),e.on("click",".click-animation-close",function(e){e.stopPropagation();let t=o(this);t.addClass("close-animation"),setTimeout(()=>t.remove(),300)})},offscreenTip(){if(!Utils.isMobile()&&(DreamConfig.document_hidden_title||DreamConfig.document_visible_title)){const t=document.title;let e=null;document.addEventListener("visibilitychange",function(){document.hidden?(DreamConfig.document_hidden_title&&(document.title=DreamConfig.document_hidden_title),clearTimeout(e)):(document.title=DreamConfig.document_visible_title||t,DreamConfig.document_visible_title&&(e=setTimeout(function(){document.title=t},2e3)))})}},sparkInput(){const o=DreamConfig.spark_input_content&&DreamConfig.spark_input_content.filter(e=>0<e.length);o&&0<o.length&&Utils.cachedScript(DreamConfig.theme_base+"/source/js/spark-input.min.js",function(){document.getElementsByClassName("main-content"),$(".spark-input").each((e,t)=>sparkInput(t,o))})},loveTime(){let c=$(".love .love-time");if(0!==c.length){var e=c.attr("data-time");if(/^\d{4}\/\d{2}\/\d{2} \d{2}:\d{2}:\d{2}$/.test(e)){const r=new Date,d=new Date(e);setInterval(function(){r.setTime(r.getTime()+1e3);var e=parseInt((r-d)/1e3),t=e%60,o=(e=parseInt(e/60))%60;let a=(e=parseInt(e/60))%24,n=parseInt(e/24),s=0,i=d.getFullYear(),l=r.getFullYear();for(;i<l;)if(i%4==0&&i%100!=0||i%400==0){if(n<366)break;n-=366,s+=1,i+=1}else{if(n<365)break;n-=365,s+=1,i+=1}0!==s?c.html(`${s} 年 ${n} 天 ${a} 时 ${o} 分 ${t} 秒`):c.html(n+` 天 ${a} 时 ${o} 分 ${t} 秒`)},1e3)}else c.html(e)}},websiteTime(){if(DreamConfig.website_time){const s=document.getElementById("websiteDate");if(/^\d{4}\/\d{2}\/\d{2} \d{2}:\d{2}:\d{2}$/.test(DreamConfig.website_time)){const i=new Date,l=new Date(DreamConfig.website_time);setInterval(function(){i.setTime(i.getTime()+1e3);let e=parseInt((i-l)/1e3),t=e%60,o=(1===String(t).length&&(t="0"+t),(e=parseInt(e/60))%60),a=(1===String(o).length&&(o="0"+o),(e=parseInt(e/60))%24);1===String(a).length&&(a="0"+a);var n=parseInt(e/24);s.innerHTML=`建站<span class="stand">${n}</span>天<span class="stand">${a}</span>时<span class="stand">${o}</span>分<span class="stand">${t}</span>秒`},1e3)}else s.innerText=DreamConfig.website_time}},initEffects(){Utils.isMobile()||(DreamConfig.cursor_move&&Utils.cachedScript(`${DreamConfig.theme_base}/source/js/cursor/move/${DreamConfig.cursor_move}.min.js`),DreamConfig.cursor_click&&Utils.cachedScript(`${DreamConfig.theme_base}/source/js/cursor/click/${DreamConfig.cursor_click}.min.js`),DreamConfig.enable_live2d&&Utils.cachedScript(DreamConfig.theme_base+"/source/lib/live2d@1.0.1/autoload.js"),DreamConfig.effects_sakura_mode&&Utils.cachedScript(DreamConfig.theme_base+"/source/js/effects/sakura.min.js"),DreamConfig.effects_universe_mode&&Utils.cachedScript(DreamConfig.theme_base+"/source/js/effects/universe.min.js"),DreamConfig.effects_circle_magic_mode&&Utils.cachedScript(DreamConfig.theme_base+"/source/js/effects/circleMagic.min.js"))},loadMaintain(){DreamConfig.enable_baidu_push&&Utils.baiduPush(),DreamConfig.enable_toutiao_push&&Utils.toutiaoPush()},showThemeVersion(){window.logger(`%c页面加载耗时：${Math.round(performance.now())}ms | Theme By Dream `+DreamConfig.theme_version,"color:#fff; background: linear-gradient(270deg, #986fee, #8695e6, #68b7dd, #18d7d3); padding: 8px 15px; border-radius: 0 15px 0 15px")}};window.commonContext=t;{const o=["sparkInput","websiteTime"],a=["initEffects","loadMaintain","showThemeVersion"];Object.keys(t).forEach(e=>!o.includes(e)&&!a.includes(e)&&t[e]()),document.addEventListener("DOMContentLoaded",function(){$("html").addClass("loaded"),o.forEach(e=>t[e]&&t[e]())}),window.addEventListener("load",function(){a.forEach(e=>t[e]&&t[e]()),$("html").addClass("ready")})}})();